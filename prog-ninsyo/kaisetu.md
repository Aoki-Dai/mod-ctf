この課題のフラグは以下になります。

解答: flag{qu3ry_pr0t0c01_m4st3r}

解説
サーバーとの通信には独自のバイナリプロトコルが使用されており、これを理解してプログラムで対話する必要がありました。手順を解説します。

1. プロトコルについて（ヒント1）
サーバーのバナーメッセージに以下の仕様が記載されています。

Each message format: [4-byte length (little-endian)][command string]

これは、何か文字（コマンド）を送る前に、「その文字の長さ」を表す**4バイトのデータ（リトルエンディアン形式）**を先に送る必要があるということです。 例えば "HELLO" という5文字のコマンドを送る場合：

長さ 5 を4バイトのリトルエンディアン \x05\x00\x00\x00 に変換して送信
その直後に文字列 "HELLO" を送信
という手順になります。単に nc で文字を打つだけでは、この「長さヘッダ」が付かないためサーバーは認識しません。

2. リクエストの送信について（ヒント2）
フラグ取得までの流れは以下の通りです。

セッションの確立: サーバーに接続するとバナーが表示されます。
トークンの取得:
コマンド HELLO をプロトコルに従って送信します。
サーバーから Your token: XXXXX... という形式でトークンが返ってきます。
データのクエリ:
取得したトークンを使って QUERY <token> というコマンドを作成し、再度プロトコルに従って送信します。
正しいトークンであれば、サーバーからフラグが返送されます。